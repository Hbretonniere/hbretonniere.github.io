<!DOCTYPE html>
<html style="font-size: 16px;">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="NeurIPS 2021:&nbsp;Probabilistic segmentation of overlapping galaxies forlarge cosmological surveys.">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>Research</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
<link rel="stylesheet" href="Research.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 3.29.1, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
    
    
    
    
    
    
    
    
    
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"logo": "images/default-logo.png"
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Research">
    <meta property="og:type" content="website">
  </head>
  <body class="u-body"><header class="u-clearfix u-header u-header" id="sec-81fa"><div class="u-clearfix u-sheet u-sheet-1">
        <a href="https://nicepage.com" class="u-image u-logo u-image-1">
          <img src="images/default-logo.png" class="u-logo-image u-logo-image-1">
        </a>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
            <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
              <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><symbol id="menu-hamburger" viewBox="0 0 16 16" style="width: 16px; height: 16px;"><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</symbol>
</defs></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="Accueil.html" style="padding: 10px 18px;">Accueil</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="Research.html" style="padding: 10px 18px;">Research</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="Conferences.html" style="padding: 10px 18px;">Conferences</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="CV.html" style="padding: 10px 18px;">CV</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="Page-1.html" style="padding: 10px 18px;">Personal Projects</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="Contact.html" style="padding: 10px 18px;">Contact</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Accueil.html" style="padding: 10px 18px;">Accueil</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Research.html" style="padding: 10px 18px;">Research</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Conferences.html" style="padding: 10px 18px;">Conferences</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="CV.html" style="padding: 10px 18px;">CV</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Page-1.html" style="padding: 10px 18px;">Personal Projects</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Contact.html" style="padding: 10px 18px;">Contact</a>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>
    <section class="u-clearfix u-section-1" id="sec-7ffa">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h6 class="u-align-center u-text u-text-default u-text-1">
          <a class="u-active-none u-border-none u-btn u-button-link u-button-style u-hover-none u-none u-text-palette-1-base u-btn-1" href="https://arxiv.org/abs/2105.12149" target="_blank"> Euclid preparation: XIII. Forecasts for galaxy morphology â€‹with the Euclid Survey using Deep Generative Models </a>
        </h6>
        <p class="u-align-justify u-text u-text-2"> In this paper, we simulate realistic galaxies with a Deep Learning model called Flow Variational AutoEncoder (FVAE). The galaxies are learn from real space images, by the <span style="font-style: italic;">Hubble Space Telescope. <span style="font-weight: 400; font-style: normal;">In addition to the realsitic morphologies learn by the VAE, we also have a good control of the parameters (size, ellipticity and sersic index) thanks to a trained regressive Flow. We used our simulation to forecast the number of <span style="font-style: italic;">interesting</span> galaxies for galaxy science that Euclid will be able to resove. We also created a benchmark to evaluate the relative speed of our model compared to classical simulations.
            </span>
          </span>
        </p>
      </div>
    </section>
    <section class="u-clearfix u-section-2" id="sec-8528">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-container-style u-layout-cell u-size-30 u-layout-cell-1">
                <div class="u-container-layout u-valign-middle u-container-layout-1">
                  <img class="u-image u-image-default u-image-1" src="images/structures.png" alt="" data-image-width="725" data-image-height="383">
                </div>
              </div>
              <div class="u-align-justify u-container-style u-layout-cell u-size-30 u-layout-cell-2">
                <div class="u-container-layout u-container-layout-2">
                  <p class="u-text u-text-default u-text-1"> Our model is able to learn complex morphologies. You can see here some examples of spiral arms, rings, clumps and bars. This is done thnaks to a Variational AutoEncoders (VAE). The VAE is amde of two convolutional Neural Networks: an Encoder and Decoder. The Encoder learns the latent distribution of pixels inside a small space, called latent space. The Decoder learns to decode a sample from this representation to recreate the input image. By minimizing the difference between the input image and its reconstruction, we force the representation in the latenstapce to be meaningful. In addition, by regularising the encoded distribution, we can sample this learnt latent space to create new galaxies.<br>Nevertheless, we don't have any control on the properties of the produced galaxies. This is why we introduce a regressive flow.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-3" id="sec-9cc1">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-align-justify u-container-style u-layout-cell u-size-33 u-layout-cell-1">
                <div class="u-container-layout u-valign-middle u-container-layout-1">
                  <p class="u-text u-text-1"> Thanks to the regressive Flow, we learn to map the physical parameter space to the latent space of the trained VAE. In practice, a galaxy with known parameter is encoded by the trained Encoder. Then, the Flow is trained to map this distribution to a Normal Gaussian distribution, conditionned to the physical parameter of the encoded galaxy. Because the transformation is bijective, we can, once trained, transform a sample from a Normal Gaussian distribution to a position in the latent space. If the Flow is well trained, this sample will be decoded to galaxy with the wanted input physical parameters. In the plot on the right, you can see some parameters fitted by a fitting algorithm on our simulated galaxies (orange) and on analytical profiles (blue), versus the true parameter of the simulated galaxy. We see no major departure between blue and orange points, meaning that our Flow is working. The small difference between the two can also be due to the fact that our complexe galaxies are harder to fit by the fitting algorithm.</p>
                </div>
              </div>
              <div class="u-container-style u-layout-cell u-size-27 u-layout-cell-2">
                <div class="u-container-layout u-container-layout-2">
                  <img class="u-expanded-height u-image u-image-default u-image-1" src="images/fig_for_website.png" alt="" data-image-width="694" data-image-height="687">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-4" id="sec-bb4d">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-container-style u-layout-cell u-size-32 u-layout-cell-1">
                <div class="u-container-layout u-container-layout-1">
                  <img class="u-image u-image-default u-image-1" src="images/forecast_sb.png" alt="" data-image-width="1197" data-image-height="641">
                </div>
              </div>
              <div class="u-container-style u-layout-cell u-size-28 u-layout-cell-2">
                <div class="u-container-layout u-container-layout-2">
                  <p class="u-text u-text-default u-text-1"> We used our simulation to forecast the number of interesting galaxies for galaxy science that Euclid will be able to resolve. By interesting, we mean galaxies with resolvable structures, irregularities. In the left plot of the figure, we show the percentage of those galaxies regarding the surface brightness of the galaxies. In red for the wide field of Euclid and in blue for the Deep Field. We show that above ~22.5, the wide field will be able to resolve barely no interesting galaxies, and around two magnitude higher for the Deep Field. On the plot on the right, we show the total number of interesting galaxies regarding the surface brightness. Even if the percentage decrease with surface brightness, because the total number of galaxies in the sky is larger at high SB, the total number of interesting galaxies increase at the beginning. In total, we estimate the number of those galaxies to be around 250 millions.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-5" id="sec-a925">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-align-center u-container-style u-layout-cell u-size-32 u-layout-cell-1">
                <div class="u-container-layout u-container-layout-1">
                  <p class="u-text u-text-default u-text-1"> We analysed carefully the running time of our simulations. We compare the time to produce the galaxies to the time made by the simple analytical profiles used in Euclid, which are known to be very fast but very limited regarding the morphology. The plot on the right presents the number of time our model is slower than the analytical simulations, regarding the number of galaxy simulated. It shows three interesting behaviour: our model is always mnore than 5 times faster when using GPUs. It is optimized when producing more galaxies in the same time (batch size, which is the natural behaviour of the model). And our model get faster when the number of simulated galaxies increase and using GPUs compared to the analytical simulation.</p>
                </div>
              </div>
              <div class="u-container-style u-layout-cell u-size-28 u-layout-cell-2">
                <div class="u-container-layout u-valign-bottom u-container-layout-2">
                  <img class="u-image u-image-default u-preserve-proportions u-image-1" src="images/speed_all.png" alt="" data-image-width="605" data-image-height="605">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-6" id="sec-3a6b">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <div class="u-expanded-width u-palette-5-light-1 u-shape u-shape-rectangle u-shape-1"></div>
        <img class="u-image u-image-default u-image-1" src="images/NN_logo1.png" alt="" data-image-width="1372" data-image-height="214">
      </div>
    </section>
    <section class="u-clearfix u-section-7" id="sec-8f31">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h1 class="u-align-center u-text u-text-default u-text-1">
          <a class="u-active-none u-border-none u-btn u-button-link u-button-style u-file-link u-hover-none u-none u-text-palette-1-base u-btn-1" href="files/neurips_final.pdf" target="_blank">NeurIPS 2021:&nbsp;Probabilistic segmentation of overlapping galaxies forlarge cosmological surveys.</a>
        </h1>
        <p class="u-align-justify u-text u-text-2"> In this on-going work published (and refereed) for the Conference on Neural Information Processing Systems (NeurIPS), we explore the use of the probabilistic
version of the U-Net (PUnet), recently proposed by Kohl et al. (2018), and adapt it to
automate the segmentation of galaxies for large photometric surveys. We focus
especially on the probabilistic segmentation of overlapping galaxies, also known
as blending. We show that, even when training with a single ground truth per
input sample, the model manages to properly capture a pixel-wise uncertainty on
the segmentation map. Such uncertainty can then be propagated further down the
analysis of the galaxy properties </p>
      </div>
    </section>
    <section class="u-clearfix u-section-8" id="sec-541c">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-align-left u-container-style u-layout-cell u-size-33 u-layout-cell-1">
                <div class="u-container-layout u-container-layout-1">
                  <img class="u-image u-image-default u-image-1" src="images/punet-1.png" alt="" data-image-width="1996" data-image-height="1406">
                </div>
              </div>
              <div class="u-container-style u-layout-cell u-size-27 u-layout-cell-2">
                <div class="u-container-layout u-valign-middle u-container-layout-2">
                  <p class="u-text u-text-default u-text-1"> The architecture
of the PUnet is made of two parts. On the one hand, there is a classical U-Net (Ronneberger et al.,
2015) architecture, whose goal is to create realistic segmentation maps from the input galaxy images.
This constitutes the deterministic part of the model. On the other hand, we have an encoder that
compresses the images into a Gaussian latent space. This latent space is sampled and concatenated to
the output of the U-Net before a final convolution layer to produce the segmentation map.
During training, the latent space is regularised using a second encoder that takes as input the ground
truth segmentation in addition to the input image. At inference time, that second encoder is removed and the samples are taken only from the latent space of the first encoder. That sampling allows one to
have multiple realisations of the segmentation and hence an estimate of the uncertainty at the pixel
level. </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-9" id="sec-c5be">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-align-justify u-container-style u-layout-cell u-size-25 u-layout-cell-1">
                <div class="u-container-layout u-container-layout-1">
                  <p class="u-text u-text-default u-text-1"> We reconstruct large fields of galaxies by running our model on smaller stamps. Our model achieves very promising results even if our dataset is complex: first, the three classes are strongly imbalanced. ~96% of the pixels belong to the background, ~3% to isolated galaxy, and 1% corresponds to the overlapping regions we would like to focus on. Second, there is a significant fraction of images with no galaxies on them, which we call background stamps. The model could easily fall in a mode where it predicts only background. Finally, because we arbitrarily cut our entire fields into stamps following a fixed grid, a significant amount of galaxies can be cut in the border of the stamps.&nbsp;</p>
                  <img class="u-image u-image-default u-image-1" src="images/Capturedecran2021-11-03a15.52.50.png" alt="" data-image-width="869" data-image-height="203">
                </div>
              </div>
              <div class="u-container-style u-layout-cell u-size-35 u-layout-cell-2">
                <div class="u-container-layout u-container-layout-2">
                  <p class="u-text u-text-default u-text-2"> INPUT AND TRUE SEGMENTATION</p>
                  <img class="u-image u-image-default u-preserve-proportions u-image-2" src="images/Capturedecran2021-11-03a15.47.28.png" alt="" data-image-width="1246" data-image-height="317">
                  <img class="u-image u-image-default u-preserve-proportions u-image-3" src="images/Capturedecran2021-11-03a15.47.15.png" alt="" data-image-width="1248" data-image-height="317">
                  <p class="u-align-center u-text u-text-default u-text-3"> PREDICTION</p>
                  <img class="u-image u-image-default u-preserve-proportions u-image-4" src="images/Capturedecran2021-11-03a15.46.55.png" alt="" data-image-width="1248" data-image-height="317">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-section-10" id="sec-4056">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-container-style u-layout-cell u-size-30 u-layout-cell-1">
                <div class="u-container-layout u-container-layout-1">
                  <img class="u-align-center u-image u-image-default u-preserve-proportions u-image-1" src="images/DOUBLE_BLEND.png" alt="" data-image-width="2362" data-image-height="999">
                </div>
              </div>
              <div class="u-align-justify u-container-style u-layout-cell u-size-30 u-layout-cell-2">
                <div class="u-container-layout u-container-layout-2">
                  <p class="u-text u-text-default u-text-1"> By sampling multiple times the encoded distribution, we can have different realisations of the segmentation for the same image. By taking the mean of those predictions, we have a probabilistic map. By looking at the standard deviation of each pixel with regards to the realisations, we can have a pixel-wise uncertainty. We show here three interesting behaviours. On the first line of the left figure, we can see that even if the model identifies correctly the difficult scene, it is uncertain on the blend region (high variance). On the second line, we can also see that the variance increases on the edges of the galaxies, where the flux is low.&nbsp;</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    
    <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-c437"><div class="u-align-left u-clearfix u-sheet u-sheet-1">
        <p class="u-align-center u-text u-text-default u-text-1"> Hubert BretonniÃ¨re Personal Page</p>
      </div></footer>
    <section class="u-backlink u-clearfix u-grey-80">
      <a class="u-link" href="https://nicepage.com/website-templates" target="_blank">
        <span>Website Templates</span>
      </a>
      <p class="u-text">
        <span>created with</span>
      </p>
      <a class="u-link" href="" target="_blank">
        <span>Website Builder Software</span>
      </a>. 
    </section>
  </body>
</html>